<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Password Reveal — Golden Luxury</title>

  <!-- Fonts & GSAP -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700;900&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/gsap@3.12.2/dist/gsap.min.js"></script>

  <!-- Firebase compat CDN (works on static hosting easily) -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

  <style>
    :root{
      --bg1:#1a1000; --bg2:#261a00;
      --accent:linear-gradient(90deg,#ffd97a,#ffbb00 50%,#ffe9a0);
      --glass:rgba(255,255,255,0.06); --glass-2:rgba(255,255,255,0.03);
      --glass-border:rgba(255,255,255,0.08); --gold:#ffd97a; --glass-blur:12px;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,Arial;background:
      radial-gradient(1200px 600px at 10% 10%,rgba(255,215,122,0.08),transparent),
      radial-gradient(1000px 500px at 90% 90%,rgba(255,187,0,0.06),transparent),
      var(--bg1);color:#fff4d6;-webkit-font-smoothing:antialiased}

    /* ---------- Responsive single-column layout (phone-optimized) ---------- */
    .stage{
      min-height:100vh;
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      padding:28px 18px;
      gap:36px;
      position:relative;
      overflow:hidden;
      text-align:center;
      max-width:720px;
      margin:0 auto;
    }

    canvas#particles{position:absolute;inset:0;z-index:0;opacity:0.55;mix-blend-mode:screen}

    .hero{z-index:2;padding:10px 0;width:100%;display:flex;flex-direction:column;align-items:center;text-align:center}
    .brand{display:flex;gap:12px;align-items:center;justify-content:center}
    .logo{width:64px;height:64px;border-radius:12px;overflow:hidden;box-shadow:0 6px 30px rgba(0,0,0,0.6);transform:translateZ(0)}
    .logo img{width:100%;height:100%;object-fit:cover;border-radius:12px}
    h1{font-family:'Playfair Display';font-weight:700;font-size:38px;line-height:1;margin:22px 0;color:#ffefc0}
    p.lead{color:rgba(255,255,255,0.8);max-width:720px;font-size:15px;margin:0 0 20px}

    .card-wrap{z-index:3;width:100%;display:flex;justify-content:center}
    .card{width:100%;max-width:520px;background:linear-gradient(180deg,var(--glass),var(--glass-2));border-radius:20px;padding:26px;border:1px solid var(--glass-border);backdrop-filter:blur(var(--glass-blur));box-shadow:0 10px 40px rgba(0,0,0,0.6)}
    .card h2{font-family:'Playfair Display';margin:0 0 12px;font-size:20px;color:#ffefc0;text-align:center}

    /* Input row stacks on small screens */
    .pwd-row{display:flex;gap:12px;align-items:center;flex-direction:column}
    input[type="password"]{width:100%;padding:14px 16px;border-radius:12px;border:none;background:rgba(255,255,255,0.02);color:#ffefc0;font-size:16px;outline:none;box-shadow:inset 0 -6px 18px rgba(0,0,0,0.4)}
    button.primary{width:100%;padding:12px 18px;border-radius:12px;border:none;background:var(--accent);background-size:300% 100%;cursor:pointer;color:#2b1b00;font-weight:700}

    .hint{font-size:13px;color:rgba(255,255,255,0.6);margin-top:12px;text-align:center}
    .msg{margin-top:12px;padding:10px;border-radius:10px;background:rgba(255,80,80,0.08);color:#ffb3b3;border:1px solid rgba(255,80,80,0.12);display:none;text-align:center}

    .reveal{margin-top:18px;padding:18px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03);min-height:92px;display:grid;align-items:center}
    .secret{font-family:'Playfair Display';font-size:15px;line-height:1.25;color:var(--gold);text-shadow:0 6px 20px rgba(0,0,0,0.7);white-space:pre-line}
    .editable{background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);border-radius:8px;padding:6px 10px;color:var(--gold);font-family:'Playfair Display';font-size:18px;margin-top:6px;width:100%;max-width:260px;outline:none}
    .save-btn{margin-top:8px;padding:6px 12px;border:none;border-radius:8px;background:var(--accent);color:#2b1b00;font-weight:600;cursor:pointer;width:100%;max-width:120px}

    .glow-line{height:2px;width:120px;background:linear-gradient(90deg,#ffbb00,#ffd97a,#ffe9a0);border-radius:20px;margin:18px auto;filter:blur(8px);opacity:0.8}
    .strip{display:none}

    .typing-caret { border-right: 2px solid rgba(255,217,122,0.95); padding-right:3px; }

    @media(min-width:900px){
      /* Slightly adjust spacing on larger screens while keeping one-column */
      .stage{padding:40px 32px;gap:48px}
      h1{font-size:44px}
      .card{max-width:520px;padding:28px}
      .pwd-row{flex-direction:row;align-items:center}
      input[type="password"]{flex:1}
      button.primary{width:auto}
    }

    @media (max-width:480px){
      h1{font-size:32px}
    }
  </style>
</head>
<body>
  <div class="stage">
    <canvas id="particles"></canvas>

    <div class="hero">
      <div class="brand">
        <div class="logo"><img src="https://i.postimg.cc/VN13TzBp/Chat-GPT-Image-Nov-10-2025-03-05-39-PM.png" alt="DV"></div>
        <div>
          <div style="font-size:12px;color:rgba(255,255,255,0.6)">PRIVATE ACCESS</div>
          <div style="font-weight:700;font-size:13px;color:rgba(255,255,255,0.85)">WALLET</div>
        </div>
      </div>

      <h1 id="title">Welcome Ms. Divya</h1>
      <div class="glow-line" aria-hidden="true"></div>
      <p class="lead"></p>
    </div>

    <div class="card-wrap">
      <div class="card" role="form" aria-labelledby="title">
        <h2>⚜️</h2>
        <div class="pwd-row">
          <input id="pwd" type="password" inputmode="numeric" placeholder="Enter password" aria-label="Password" />
          <button id="submit" class="primary">Submit</button>
        </div>

        <div class="hint">CREDENTIALS</div>
        <div class="msg" id="msg">Incorrect password. Try again.</div>

        <div class="reveal">
          <div class="secret" id="secret" style="opacity:0;transform:translateY(8px);"></div>
        </div>
      </div>
    </div>

    <div class="strip" aria-hidden="true"></div>
  </div>

  <script>
    // ---------- Firebase config and init (compat CDN) ----------
    const firebaseConfig = {
      apiKey: "AIzaSyCtrX1wzW-3v3yrETVa0LtpLT1bTfL5jgI",
      authDomain: "gbbdd-f6411.firebaseapp.com",
      databaseURL: "https://gbbdd-f6411-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "gbbdd-f6411",
      storageBucket: "gbbdd-f6411.firebasedestorage.app",
      messagingSenderId: "1055596299567",
      appId: "1:1055596299567:web:a7a1c12af8eaf90a9b4dda",
      measurementId: "G-1WKLZLJH5G"
    };
    // initialize firebase
    try { firebase.initializeApp(firebaseConfig); } catch (e) { /* already initialized? */ }
    const db = firebase.database();
    const dbRef = db.ref('passwordMessage');

    // ---------- constants & elements ----------
    const CORRECT = '03051997';
    const EMAIL_LINE = `E= divyaakalee@gmail.com`;
    const pwd = document.getElementById('pwd');
    const btn = document.getElementById('submit');
    const msg = document.getElementById('msg');
    const secretEl = document.getElementById('secret');

    // ---------- typed reveal (per-letter) ----------
    function typeWriterEffect(text, element, delay = 40, callback) {
      element.textContent = '';
      element.classList.add('typing-caret');
      let i = 0;
      const step = () => {
        if (i < text.length) {
          element.textContent += text.charAt(i);
          i++;
          setTimeout(step, delay);
        } else {
          element.classList.remove('typing-caret');
          if (callback) callback();
        }
      };
      step();
    }

    // ---------- firebase helpers ----------
    async function fetchPValue() {
      try {
        const snap = await db.ref('passwordMessage/pValue').get();
        if (snap && snap.exists()) {
          return snap.val();
        } else {
          // initialize if missing
          await db.ref('passwordMessage').set({ pValue: 'P= Divyashree', email: 'divyaakalee@gmail.com' });
          return 'P= Divyashree';
        }
      } catch (e) {
        console.error('Firebase fetch error', e);
        return 'P= Divyashree';
      }
    }

    async function savePValue(value) {
      try {
        await db.ref('passwordMessage/pValue').set(value);
        // ensure email also present (optional)
        await db.ref('passwordMessage/email').set('divyaakalee@gmail.com');
        return true;
      } catch (e) {
        console.error('Firebase save error', e);
        return false;
      }
    }

    // Listen for remote changes so the page sees updates live
    dbRef.on('value', (snapshot) => {
      const data = snapshot.val();
      if (!data) return;
      window._remoteP = data.pValue || 'P= Divyashree';
    }, (err) => {
      console.error('db on error', err);
    });

    // ---------- showSecret: typed lines, then editable input + save ----------
    async function showSecret() {
      msg.style.display = 'none';
      gsap.to(secretEl, { opacity: 1, y: 0, duration: 0.9, ease: 'power3.out' });

      const pVal = await fetchPValue(); // returns full "P= ..." string
      const line1 = EMAIL_LINE;
      const line2 = pVal;

      secretEl.textContent = '';
      // type line1
      typeWriterEffect(line1, secretEl, 30, () => {
        // newline + type line2 into a span
        secretEl.appendChild(document.createElement('br'));
        const line2El = document.createElement('span');
        secretEl.appendChild(line2El);
        typeWriterEffect(line2, line2El, 30, async () => {
          // after typing, append input + save
          secretEl.appendChild(document.createElement('br'));

          const input = document.createElement('input');
          input.className = 'editable';
          input.id = 'editableP';

          // strip leading "P=" for the input value
          let justValue = line2;
          if (justValue.startsWith('P=')) justValue = justValue.replace(/^P=\s*/, '');
          input.value = justValue;

          const br = document.createElement('br');
          const saveBtn = document.createElement('button');
          saveBtn.className = 'save-btn';
          saveBtn.id = 'saveP';
          saveBtn.textContent = 'Save';

          secretEl.appendChild(input);
          secretEl.appendChild(br);
          secretEl.appendChild(saveBtn);

          saveBtn.addEventListener('click', async () => {
            const newValRaw = (document.getElementById('editableP').value || '').trim();
            if (!newValRaw) {
              alert('Please enter a valid value');
              return;
            }
            const fullP = 'P= ' + newValRaw;
            const ok = await savePValue(fullP);
            if (ok) {
              gsap.fromTo(saveBtn, { scale: 0.98 }, { scale: 1.04, duration: 0.18, yoyo: true, repeat: 1 });
              // update the visible typed line span
              const spanAfter = secretEl.querySelector('span');
              if (spanAfter) spanAfter.textContent = fullP;
              alert('BINGO ✅.');
            } else {
              alert('Failed saving to server.');
            }
          });
        });
      });
    }

    // ---------- show error ----------
    function showError() {
      msg.style.display = 'block';
      msg.style.opacity = 0;
      gsap.to(msg, { opacity: 1, y: -2, duration: 0.45, ease: 'power2.out' });
    }

    // ---------- events ----------
    btn.addEventListener('click', () => {
      const v = pwd.value.trim();
      if (!v) { pwd.focus(); return; }
      if (v === CORRECT) { showSecret(); }
      else { showError(); }
    });
    pwd.addEventListener('keydown', (e) => { if (e.key === 'Enter') btn.click(); });

    // ---------- decorative particles background ----------
    (function () {
      const canvas = document.getElementById('particles');
      const ctx = canvas.getContext('2d');
      let W = canvas.width = innerWidth;
      let H = canvas.height = innerHeight;
      const parts = [];
      const colors = ['rgba(255,217,122,0.22)', 'rgba(255,187,0,0.18)', 'rgba(197,140,255,0.08)'];

      function rand(min, max) { return Math.random() * (max - min) + min; }
      function initializeParticles() {
        parts.length = 0;
        const count = Math.round((W * H) / 18000);
        for (let i = 0; i < count; i++) {
          parts.push({
            x: Math.random() * W,
            y: Math.random() * H,
            r: rand(0.6, 3.2),
            vx: rand(-0.12, 0.12),
            vy: rand(-0.04, 0.04),
            c: colors[i % colors.length]
          });
        }
      }
      function draw() {
        ctx.clearRect(0, 0, W, H);
        for (const p of parts) {
          p.x += p.vx; p.y += p.vy;
          if (p.x < -10) p.x = W + 10; if (p.x > W + 10) p.x = -10;
          if (p.y < -10) p.y = H + 10; if (p.y > H + 10) p.y = -10;
          ctx.beginPath(); ctx.fillStyle = p.c; ctx.globalCompositeOperation = 'lighter';
          ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2); ctx.fill();
        }
        requestAnimationFrame(draw);
      }
      window.addEventListener('resize', () => { W = canvas.width = innerWidth; H = canvas.height = innerHeight; initializeParticles(); });
      initializeParticles(); draw();
    })();

    // micro-entrances
    gsap.from('.logo', { y: 20, opacity: 0, duration: 0.9, ease: 'power3.out' });
    gsap.from('#title', { y: 18, opacity: 0, duration: 1, delay: 0.12, ease: 'power3.out' });
    gsap.from('.card', { y: 24, opacity: 0, duration: 1.1, delay: 0.25, ease: 'power3.out' });

    // focus
    pwd.focus();
  </script>
</body>
</html>
